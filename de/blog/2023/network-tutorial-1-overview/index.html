<!doctype html><html lang=de><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/sass/main.min.506f38269dc32005efe6c55ed917ccb4862d29bd1e6efed5cc6ce23f984a774cb6213c1435bdafbb2b4815176a90a7ec03036a6f42f40c20daf293b0fc36d07b.css integrity="sha512-UG84Jp3DIAXv5sVe2RfMtIYtKb0ebv7VzGziP5hKd0y2ITwUNb2vuytIFRdqkKfsAwNqb0L0DCDa8pOw/DbQew=="><link rel=stylesheet href=/css/all.min.a0921f068fa9017ba1288b77420fbde17d89619431fab12b4d996e3e124af17337ac1b80bc2bb62458509e6033ace757405b5881b0c1d0db837dd64c8783b607.css integrity="sha512-oJIfBo+pAXuhKIt3Qg+94X2JYZQx+rErTZluPhJK8XM3rBuAvCu2JFhQnmAzrOdXQFtYgbDB0NuDfdZMh4O2Bw=="><title>Something Like Games | Netzwerktutorial 1: Allgemeines und Übersicht</title><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><meta name=description content="Der Auftakt einer Tutorialserie zum Thema Netzwerkprogrammierung mit Godot 4. Hier gibt es eine Übersicht der behandelten Themen und weitere allgemeine Informationen."><meta itemprop=description content="Der Auftakt einer Tutorialserie zum Thema Netzwerkprogrammierung mit Godot 4. Hier gibt es eine Übersicht der behandelten Themen und weitere allgemeine Informationen."><meta name=twitter:description content="Der Auftakt einer Tutorialserie zum Thema Netzwerkprogrammierung mit Godot 4. Hier gibt es eine Übersicht der behandelten Themen und weitere allgemeine Informationen."><meta property="og:description" content="Der Auftakt einer Tutorialserie zum Thema Netzwerkprogrammierung mit Godot 4. Hier gibt es eine Übersicht der behandelten Themen und weitere allgemeine Informationen."></head><body><nav class="navbar is-light" role=navigation aria-label="main navigation"><div class=navbar-brand><a href=/de/ class=navbar-item><img src=/images/brand.webp alt="Something Like Games" width=128px height=28></a>
<a role=checkbox class=navbar-burger aria-label=menu aria-expanded=false data-target=navigation><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a></div><div id=navigation class=navbar-menu><div class=navbar-end><div class=navbar-item><a href=/de/ class="nav link icon-text"><span class=icon><i class='fa fa-home'></i></span><span>Home</span></a></div><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link href=#>Deutsch (de)</a><div class="navbar-dropdown is-right"><a href=https://www.somethinglikegames.de/en/blog/2023/network-tutorial-1-overview/ lang=en class=navbar-item>English (en)</a></div></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-one-fifth"><section id=site-sidebar class=is-hidden-mobile><section id=site-intro class="block has-text-centered"><a href=/de/><img src=/images/logo.webp class=circle width=128px height=128px alt=somethinglikegames.de></a><header></header><main><p>Mein persönlicher Blog über Spieleentwicklung als Einzelperson in Teilzeit</p></main><footer class="footer has-no-background"><span class=icon><a href=//github.com/somethinglikegames target=_blank rel=noopener title=GitHub class="fab fa-github"></a></span>
<span class=icon><a href=//youtube.com/@somethinglikegames target=_blank rel=noopener title=YouTube class="fab fa-youtube"></a></span>
<span id=cloaked-97d6a8c75b></span>
<script id=cloaked-script-97d6a8c75b>var cloakElement=document.getElementById("cloaked-97d6a8c75b"),link=document.createElement("a"),address="ed.semagekilgnihtemos@ofni".split("").reverse().join("");link.href="mailto:"+address,link.classList="far fa-envelope",link.title="email",cloakElement.parentNode.replaceChild(link,cloakElement)</script></footer></section><div class=block><hr></div><section id=categories class="block categories"><header><h1><a href=/de/categories><span class=icon-text><span class=icon><i class="fa fa-folders"></i></span><span>Kategorien</span></span></a></h1></header><ul><li><a href=/de/categories/misc/><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span><span>misc</span></span><span class=count>2</span></a><li><a href=/de/categories/news/><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span><span>news</span></span><span class=count>1</span></a><li><a href=/de/categories/tutorial/><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span><span>tutorial</span></span><span class=count>1</span></a></li></ul></section></section></div><div class=column><article class=card><div class=card-image><figure class=image><a href=/de/blog/2023/network-tutorial-1-overview/ class=cover-image style="--bg-image:url('https://www.somethinglikegames.de/images/blog/2023/network-tutorial-1-overview/godot_networking.webp')"><img class=cover src=https://www.somethinglikegames.de/images/blog/2023/network-tutorial-1-overview/godot_networking.webp alt="Godot Engine Logos, die miteinander 'kommunizieren'"></a><div class=copyright><a href=https://github.com/godotengine/godot/blob/master/LOGO_LICENSE.md class=has-text-grey target=_blank rel="noopener nofollow noreferrer">Godot Engine Logo is licensed under CC-BY-4.0 international</a></div></figure></div><header class=card-header><div class=card-header-title><h2 class=title><a href=/de/blog/2023/network-tutorial-1-overview/>Netzwerktutorial 1: Allgemeines und Übersicht</a></h2></div></header><div class="card-content is-size-5 content"><div class=columns><div class=column><time datetime="2023-01-29 12:00:00 +0100 +0100">29.01.2023</time></div></div><div class=columns><div class=column><div class=tags><span class="tag is-info is-light"><a href=/de/categories/tutorial/ class=has-text-info><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span>
<span>Tutorial</span></span></a></span>
<span class="tag is-link is-light"><a href=/de/tags/networking-tutorial/ class=has-text-link><span class=icon-text><span class=icon><i class="fa fa-tag"></i></span>
<span>Networking-Tutorial</span></span></a></span>
<span class="tag is-link is-light"><a href=/de/tags/godot-engine/ class=has-text-link><span class=icon-text><span class=icon><i class="fa fa-tag"></i></span>
<span>Godot Engine</span></span></a></span>
<span class="tag is-link is-light"><a href=/de/tags/networking/ class=has-text-link><span class=icon-text><span class=icon><i class="fa fa-tag"></i></span>
<span>Networking</span></span></a></span></div></div></div><p>Godot 4 ist auf dem Weg zum ersten Release Candidate. <a href=https://godotengine.org/article/dev-snapshot-godot-4-0-beta-1/ target=_blank rel="noopener nofollow noreferrer">Der Unterschied zwischen Godot 3.x und Godot 4 ist gewaltig</a>. Während es schon diverse Tutorials zu vielen der Änderungen gibt, kommt es mir so vor, als ob der Bereich der Netzwerkprogrammierung vernachlässigt wurde und das, obwohl, oder vielleicht weil, es dort auch eine <a href=https://godotengine.org/article/multiplayer-changes-godot-4-0-report-1/ target=_blank rel="noopener nofollow noreferrer">Menge Änderungen</a> gab. Dazu kommt, dass mich dieser Teil besonders interessiert, da es bislang fast nur pure Multiplayer-Spiele geschafft haben, mich längere Zeit zu fesseln und ich in diesem Bereich meine berufliche Erfahrung gut mit einbringen kann.</p><p>Da das Thema so umfangreich ist, dass sich darüber wahrscheinlich auch ein Buch schreiben ließe, werde ich es im Rahmen einer Tutorialserie behandeln. Die folgende Liste zeigt alle bislang erschienenen Artikel dieser Serie:</p><ol><li>Netzwerktutorial 1: Allgemeines und Übersicht</li></ol><h3 class="title is-4" id=übersicht>Übersicht</h3><p>Diese Tutorialserie ist dazu gedacht, einen Einstieg in das Thema Netzwerkprogrammierung mit Godot 4 zu bekommen. Aus diesem Grund wird alles, was im Rahmen dieser Serie erstellt wird, mit der aktuellen Godot 4 Version erstellt, auch wenn dies in der Realität nicht unbedingt der Fall sein wird, da es für bestimmte Aufgaben bessere Technologien gibt. Bevor es aber im nächsten Artikel mit der Praxis losgeht, möchte ich hier zuerst über einige Themen sprechen, die die gewählte Architektur beeinflussen, um anschließend die von mir angestrebte Architektur vorzustellen.</p><p>Wenn man ohne jegliche Vorerfahrungen über das Thema Server-Architektur für reine Multiplayer-Spiele nachdenkt, kommt man wohl zuerst auf eine solche Idee:</p><figure class="title is-6"><img src=/images/blog/2023/network-tutorial-1-overview/dedicated-server-first-draft.webp alt="Spieleclients können direkt mit dem einzigen dedizierten Spielserver via Internet kommunizieren."><figcaption><h4>Spieleclients können direkt mit dem einzigen dedizierten Spielserver via Internet kommunizieren.</h4></figcaption></figure><p>Möglicherweise wird bei diesen ersten Überlegungen noch daran gedacht, dass der dedizierte Server eventuell noch eine Datenbank benötigt, aber das ist aktuell nur ein kleines Detail. Es gibt mit einem einzelnen dedizierten Server sicherlich viele Probleme, die größten sind meiner Meinung nach aber:</p><ol><li>Sicherheit</li><li>Skalierbarkeit</li></ol><p>Die Server-Architektur für reine Multiplayer-Spiele muss zumindest zwei Aufgaben erfüllen: Neue Clients authentifizieren und anschließend die spielrelevante Kommunikation mit allen Clients übernehmen. Für die Authentifizierung werden Benutzerdaten benötigt, die auf gar keinen Fall in falsche Hände gelangen sollten, aber in diesem Fall auf einem Server liegen, der direkt ans Internet angeschlossen ist. Zumal der Zugriff nicht auf bestimmte IP-Adressen eingeschränkt werden kann, da dadurch potentielle Spieler abgewiesen werden würden. Von nicht vorhandener Ausfallsicherheit muss man in diesem Szenario ja erst gar nicht anfangen zu sprechen. Wenn der Server nicht verfügbar ist, ist weder der Multiplayer verfügbar noch sind die Spieler in der Lage, ihre Benutzerdaten zu ändern.<br>Die Anzahl möglicher Spieler ist generell von verschiedenen Faktoren abhängig, worauf ich im <a href=#bottlenecks>nächsten Abschnitt</a> näher eingehen werde, aber eine gewisse Obergrenze ist allgegenwärtig. Möchte man also die Grenze nach oben verschieben, so werden mehrere Server benötigt und dabei sollte auch nicht jeder Server alle Benutzerdaten speichern.</p><h3 id=bottlenecks class="title is-4">Mögliche Bottlenecks</h3><p>Es gibt verschiedene Faktoren, die Einfluss auf die Anzahl gleichzeitig verbundener Spieler pro Server haben:</p><ol><li>Maximale Anzahl gleichzeitig verbundener Spieler</li><li>Requests pro Sekunde (RPS)</li><li>Spieleranzahl, die sinnvoll auf der Spielwelt/der Map untergebracht werden kann</li></ol><p>Bei der Nutzung von <a href=http://enet.bespin.org/ target=_blank rel="noopener nofollow noreferrer">ENet</a> mit Godot gibt es eine Obergrenze von <a href=https://docs.godotengine.org/en/latest/classes/class_enetmultiplayerpeer.html#class-enetmultiplayerpeer-method-create-server target=_blank rel="noopener nofollow noreferrer">4095 gleichzeitigen Verbindungen</a>, was bedeutet, dass mehr Spieler pro Server erst einmal nicht möglich sind. Sollte man dennoch mehr als ~4k Spieler zeitgleich in einer Spielwelt unterstützen wollen, muss man die Spielwelt auf mehrere Server verteilen. Dazu wird die Spielwelt in Zonen unterteilt und diese Zonen auf die Server verteilt. Im Optimalfall wird diese Verteilung abhängig von der jeweiligen Auslastung dynamisch zur Laufzeit vorgenommen, um Ressourcen zu sparen. Aber durch die Aufteilung auf mehrere Server steigt die bereits hohe Komplexität nochmal deutlich an, da man Lösungen entwickeln muss, um Spielern Serverwechsel bspw. beim Zonenwechsel zu ermöglichen, im Optimalfall, ohne dass die Spieler dies bemerken. Aber das Thema ist so komplex, dass es eigene Artikel rechtfertigt.<br>Die notwendige Anzahl von Requests pro Sekunde (RPS) ist abhängig vom gewählten Genre. In schnellen und interaktionsreichen Genres wie bspw. Ego-Shootern ist es essentiell, möglichst viele RPS zu haben, damit alle Spieleclients ihre notwendigen Spieldaten (z.B. eigene Position, Positionen der Mitspieler, Positionen &ldquo;sichtbarer&rdquo; Gegner) so schnell wie möglich bekommen, um sie annähernd verzögerungsfrei darzustellen, sodass der Spieler reagieren kann. Für Spiele wie z.B. FarmVille ist es auch ausreichend, nur wenige RPS zu haben, da einerseits der Multiplayer meines Wissens nur wenig benutzt wird und andererseits es nicht so spielrelevant ist, wo genau sich Besucher der eigenen Farm gerade befinden. Natürlich ist die Anzahl realistisch zu erreichender RPS auch davon abhängig, wie aufwendig die serverseitigen Berechnungen sind und wieviel Rechenkapazität verfügbar ist.<br>Um Spielern eine gute Spielerfahrung zu ermöglichen, sollte die Spieleranzahl an die Mapgröße, das Genre und die zentralen Spielmechaniken angepasst sein. Bei kompetitiven Spielen sollte die Kartengröße groß genug sein, dass gegnerische Spieler(teams) nicht direkt beieinander spawnen, aber klein genug, dass gegnerische Spieler(teams) dennoch zeitnah aufeinandertreffen. Bei <a href=https://www.huntshowdown.com/game target=_blank rel="noopener nofollow noreferrer">Hunt:Showdown</a> ist eine zentrale Spielmechanik, dass eigentlich alles in der Spielwelt Geräusche verursacht, die dank <a href=https://en.wikipedia.org/wiki/3D_audio_effect target=_blank rel="noopener nofollow noreferrer">3D Spatial Audio</a> gut lokalisiert werden können, daher versuchen viele Spieler, möglichst lange verdeckt zu agieren. Um dieser Spielmechanik gerecht zu werden, ist die Map mit 1 Quadratkilometer für maximal 12 Spieler aufgeteilt in durchschnittlich 6 Teams sehr spärlich von Spielern &ldquo;bevölkert&rdquo;. In (M)MORPGs ist die Welt zwar meist auf Hunderte bis Tausende von Spielern ausgelegt, aber trotz allem kommt es auch dabei immer zu Situationen, wo bestimmte Gebiete komplett überlaufen sind, sodass an Questen dann nicht zu denken ist. Jeder, der bei einem Livegang einer WoW-Erweiterung spielen wollte, weiß, was ich damit meine.</p><h3 class="title is-4" id=die-im-tutorial-angestrebte-architektur>Die im Tutorial angestrebte Architektur</h3><figure class="title is-6"><img src=/images/blog/2023/network-tutorial-1-overview/desired_network_architecture.webp alt="Die Spieleclients besorgen sich über den Gateway beim Authentication Server ein Token, welches sie benötigen, um Kontakt zum World Server aufzubauen."><figcaption><h4>Die Spieleclients besorgen sich über den Gateway beim Authentication Server ein Token, welches sie benötigen, um Kontakt zum World Server aufzubauen.</h4></figcaption></figure><p>Das Bild veranschaulicht die Architektur, die im Lauf dieser Tutorialserie erstellt werden soll. Sie besteht aus drei verschiedenen Arten von Servern:</p><dl><dt><strong>Gateway Server</strong></dt><dd>Schützt den Authentication Server vor direkten Zugriffen aus dem Internet und leitet nur valide Anfragen an den Authentication Server weiter.</dd><dt><strong>Authentication Server</strong></dt><dd>Besitzt Zugriff auf die Benutzerdaten, um Logindaten validieren zu können und stellt bei validen Logindaten ein Token für den Zugriff auf die World Server aus.</dd><dt><strong>World Server</strong></dt><dd>Validiert ausgestellte Tokens und stellt das eigentliche Spiel bereit. In diesem Beispiel besitzt jeder World Server eigene Spielerdaten, d.h. es handelt sich dabei um ein Spiel mit persistenten Daten bspw. ein (M)MORPG.</dd></dl><p>Neben der Architektur kann man in dem Bild auch die Kommunikation erkennen:</p><ol><li>Der Spieleclient schickt die Login-Daten an einen der Gateway Server</li><li>Der Gateway Server leitet die Login-Daten an den Authentication Server weiter, welcher sie dann überprüft</li><li>Das Resultat wird an den Gateway Server gesendet:<ol><li>Im Positivfall ein Token</li><li>Im Negativfall ein Fehlercode</li></ol></li><li>Der Gateway Server leitet das Resultat an den Spieleclient weiter</li><li>Wenn der Spieleclient ein Token bekommen hat, sendet er den Token an den gewünschten World Server weiter</li><li>Der World Server validiert den Token und sollte er gültig sein, beginnt das eigentliche Spiel</li></ol><p>Diese Architektur bildet meiner Meinung nach eine gute Möglichkeit die Netzwerkprogrammierung mit Godot 4 zu lernen und zu verstehen. Das eigene Spiel wird sicherlich andere Anforderungen haben, aber so hat man eine gute Grundlage, um sie dann an die eigenen Bedürfnisse anzupassen.</p></div></article><footer class=columns><div class="column has-text-left"><a href=/de/blog/2023/status-of-godot-4/ class="button right"><span class=icon-text><span class=icon><i class="fa fa-angle-left"></i></span><span>Ist Godot 4 bereit für AA- oder sogar AAA?</span></span></a></div><div class="column has-text-right"></div></footer></div></div></div></section><footer class=footer><div class="container is-fluid has-text-centered"><ul class=socnet-icons><span class=icon><a href=//github.com/somethinglikegames target=_blank rel=noopener title=GitHub class="fab fa-github"></a></span>
<span class=icon><a href=//youtube.com/@somethinglikegames target=_blank rel=noopener title=YouTube class="fab fa-youtube"></a></span>
<span id=cloaked-d6e4d30215></span>
<script id=cloaked-script-d6e4d30215>var cloakElement=document.getElementById("cloaked-d6e4d30215"),link=document.createElement("a"),address="ed.semagekilgnihtemos@ofni".split("").reverse().join("");link.href="mailto:"+address,link.classList="far fa-envelope",link.title="email",cloakElement.parentNode.replaceChild(link,cloakElement)</script></ul><p class=copyright><a href=https://www.somethinglikegames.de/de/legal_notice/>Impressum</a> &mdash;
<a href=https://www.somethinglikegames.de/de/privacy_policy/>Datenschutzerklärung</a> &mdash;
©2023 Tobias Wink<br>Powered by <a href=https://gohugo.io/ title=0.109.0 target=_blank rel=noopener>Hugo</a></p></div></footer><script src=/js/navbar.min.js defer></script></body></html>