<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/sass/main.min.f6d044b67731fc418190a304668c848b0e240406fe652d5b63b8b82680bf6950585f1957e5bdc647161ed8b86a2ba218f28847056ae8f4c6c5d98d990c42f613.css integrity="sha512-9tBEtncx/EGBkKMEZoyEiw4kBAb+ZS1bY7i4JoC/aVBYXxlX5b3GRxYe2LhqK6IY8ohHBWro9MbF2Y2ZDEL2Ew=="><link rel=stylesheet href=/css/all.min.a0921f068fa9017ba1288b77420fbde17d89619431fab12b4d996e3e124af17337ac1b80bc2bb62458509e6033ace757405b5881b0c1d0db837dd64c8783b607.css integrity="sha512-oJIfBo+pAXuhKIt3Qg+94X2JYZQx+rErTZluPhJK8XM3rBuAvCu2JFhQnmAzrOdXQFtYgbDB0NuDfdZMh4O2Bw=="><title>Something Like Games | Interest Management mit dem MultiplayerSynchronizer</title><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/ms-icon-144x144.png"><meta name=theme-color content="#ffffff"><meta name=description content="In diesem Tutorial geht es um die Umsetzung von Interest Management mit dem MultiplayerSynchronizer."><meta itemprop=description content="In diesem Tutorial geht es um die Umsetzung von Interest Management mit dem MultiplayerSynchronizer."><meta name=twitter:description content="In diesem Tutorial geht es um die Umsetzung von Interest Management mit dem MultiplayerSynchronizer."><meta property="twitter:image" content="https://www.somethinglikegames.de/images/blog/2023/interest-management-with-multiplayersynchronizer/intro.webp"><meta property="og:description" content="In diesem Tutorial geht es um die Umsetzung von Interest Management mit dem MultiplayerSynchronizer."><meta property="og:image" content="https://www.somethinglikegames.de/images/blog/2023/interest-management-with-multiplayersynchronizer/intro.webp"></head><body><nav class="navbar is-light" role=navigation aria-label="main navigation"><div class=navbar-brand><a href=/en/ class=navbar-item><img src=/images/brand.webp alt="Something Like Games" width=128px height=28></a>
<a role=checkbox class=navbar-burger aria-label=menu aria-expanded=false data-target=navigation><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a></div><div id=navigation class=navbar-menu><div class=navbar-end><div class=navbar-item><a href=/en/ class="nav link icon-text"><span class=icon><i class='fa fa-home'></i></span><span>Home</span></a></div><div class=navbar-item><a href=/en/contact/ class="nav link icon-text"><span class=icon><i class='fa fa-mail-bulk'></i></span><span>Contact</span></a></div><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link href=#>English (en)</a><div class="navbar-dropdown is-right"><a href=https://www.somethinglikegames.de/de/blog/2023/interest-management-with-multiplayersynchronizer/ lang=de class=navbar-item>Deutsch (de)</a></div></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-one-fifth"><section id=site-sidebar class=is-hidden-mobile><section id=site-intro class="block has-text-centered"><a href=/en/><img src=/images/logo.webp class=circle width=128px height=128px alt=somethinglikegames.de></a><header></header><main><p>My personal Blog about Game Development as a single person in part time</p></main><footer class="footer has-no-background"><span class=icon><a href=//github.com/somethinglikegames target=_blank rel=noopener title=GitHub class="fab fa-github"></a></span>
<span class=icon><a href=//youtube.com/@somethinglikegames target=_blank rel=noopener title=YouTube class="fab fa-youtube"></a></span>
<span id=cloaked-39954257c8></span>
<script id=cloaked-script-39954257c8>var cloakElement=document.getElementById("cloaked-39954257c8"),link=document.createElement("a"),address="ed.semagekilgnihtemos@ofni".split("").reverse().join("");link.href="mailto:"+address,link.classList="far fa-envelope",link.title="email",cloakElement.parentNode.replaceChild(link,cloakElement)</script></footer></section><div class=block><hr></div><section id=categories class="block categories"><header><h1><a href=/en/categories><span class=icon-text><span class=icon><i class="fa fa-folders"></i></span><span>Categories</span></span></a></h1></header><ul><li><a href=/en/categories/tutorials/><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span><span>tutorials</span></span><span class=count>8</span></a><li><a href=/en/categories/misc/><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span><span>misc</span></span><span class=count>3</span></a><li><a href=/en/categories/news/><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span><span>news</span></span><span class=count>2</span></a></li></ul></section></section></div><div class=column><article class=card><div class=card-image><a href=/en/blog/2023/interest-management-with-multiplayersynchronizer/ class=cover-image style="--bg-image:url('https://www.somethinglikegames.de/images/blog/2023/interest-management-with-multiplayersynchronizer/intro.webp')"><img class=stretchV src=https://www.somethinglikegames.de/images/blog/2023/interest-management-with-multiplayersynchronizer/intro.webp alt="A split image, where on the left side you see a Godot logo, which is spammed by other small Godot logos with text. On the right side you see the Godot logo again, but this time only with another smaller logo asking for help. This smaller logo also exists on the left side, but is lost among all the other logos."></a><div class=copyright><a href=https://github.com/godotengine/godot/blob/master/LOGO_LICENSE.md class=has-text-grey target=_blank rel="noopener nofollow noreferrer">Godot Engine Logo is licensed under CC-BY-4.0 international</a></div></div><header class=card-header><div class=card-header-title><h2 class=title><a href=/en/blog/2023/interest-management-with-multiplayersynchronizer/>Interest Management mit dem MultiplayerSynchronizer</a></h2></div></header><div class="card-content is-size-5 content"><div class=columns><div class=column><time datetime="2023-07-15 14:00:00 +0200 +0200">July 15, 2023</time></div></div><div class=columns><div class=column><div class=tags><span class="tag is-info is-light"><a href=/en/categories/tutorials/ class=has-text-info><span class=icon-text><span class=icon><i class="fa fa-folder"></i></span>
<span>Tutorials</span></span></a></span>
<span class="tag is-link is-light"><a href=/en/tags/godot-engine/ class=has-text-link><span class=icon-text><span class=icon><i class="fa fa-tag"></i></span>
<span>Godot Engine</span></span></a></span>
<span class="tag is-link is-light"><a href=/en/tags/networking/ class=has-text-link><span class=icon-text><span class=icon><i class="fa fa-tag"></i></span>
<span>Networking</span></span></a></span></div></div></div><p>After we were able to gather first experiences with the <a href=https://docs.godotengine.org/en/stable/classes/class_multiplayersynchronizer.html target=_blank rel="noopener nofollow noreferrer"><code>MultiplayerSynchronizer</code></a> in <a href=/en/tags/networking-tutorial/>the article about Scene Replication</a>, we want to continue to make our experiences with it in this article. In addition to the synchronization interval, the <code>MultiplayerSynchronizer</code> has other configuration options that can be used to do interesting things.</p><p>In this article we want to deal with the topic of <em>Interest Management</em>. In network games, this means that the respective game clients only receive the information about the other players that the player really needs to be able to perceive everything in his environment. This tries to keep the network communication per connected GameClient / player as small as possible. As a side effect, this reduces the risk of wallhacks etc. in competitive games, since the GameClient ideally only receives and processes the information that the player can perceive (see or hear). Basically, it is based on the fact that every game character has (at least) one <em>Area of Interest</em> (<em>AoI</em>). When something happens within this area, for example another game character moves within the area, the GameClient is informed about it, so that it can also display this movement. You could also work with multiple <em>AoI</em> to represent different aspects of it, e.g. if the player can see further than hear, you could use a separate <em>AoI</em> for each sense.</p><p>On the subject of <em>Interest Management</em>, a <a href=https://github.com/godotengine/godot-proposals/issues/3904 target=_blank rel="noopener nofollow noreferrer">Godot Proposal</a> worth reading was published in February 2022, which Fabio Alessandrelli then also implemented in the context of Godot 4 by integrating it into the <code>MultiplayerSynchronizer</code>. The corresponding pull request with concrete implementation can be found <a href=https://github.com/godotengine/godot/pull/62961 target=_blank rel="noopener nofollow noreferrer">here</a>. But let&rsquo;s have a look at a concrete example for a better understanding of the whole topic.</p><p>We&rsquo;ll start with the <a href=https://github.com/somethinglikegames/godot4-network-tutorial/tree/scene-replication target=_blank rel="noopener nofollow noreferrer">example project</a> from the <a href=/en/tags/networking-tutorial/>article on Scene Replication</a>. If you don&rsquo;t have it anymore, you can find it in the associated <a href=https://github.com/somethinglikegames/godot4-network-tutorial/tree/scene-replication target=_blank rel="noopener nofollow noreferrer">Github repository</a>. I thought we extend the project so that the game character inside the <code>Player</code> scene gets an <em>AoI</em> in the form of an <code>Area3D</code> with associated <code>CollisionShape3D</code>. As shape we take a <code>CylinderShape3D</code> with a radius of 5m, so that our player character has a circular <em>AoI</em> with 5m radius. This should allow us to notice the effect very well in our example.</p><figure class="title is-6 is-centered"><img src=/images/blog/2023/interest-management-with-multiplayersynchronizer/player_scene.webp alt="The player scene incl. 3D view"><figcaption><h4>The player scene incl. 3D view</h4></figcaption></figure><p><figure class="title is-6 is-pulled-right"><img src=/images/blog/2023/interest-management-with-multiplayersynchronizer/server_synchronizer_inspector.webp alt="Configuration of the ServerSynchronizer"><figcaption><h4>Configuration of the ServerSynchronizer</h4></figcaption></figure>Before we look at the associated source code, we need to do some more preliminary work. The idea is that the <code>Area3D</code> is our <em>AoI</em>. This means that all game characters that &ldquo;collide&rdquo; with our <em>AoI</em> are of interest, all others are of no interest to us. So for the implementation we have to link the <code>body_entered</code> and <code>body_exited</code> signals of our <code>Area3D</code> with our player script.</p><p>Additionally we have to activate <em>Interest Management</em> in the <code>MultiplayerSynchronizer</code>. For this we set the property <code>public_visibility</code> of the synchronizer to <code>false</code>. This can be done either script-based or by unchecking the appropriate box via the Inspector, as I did here in the accompanying screenshot. Now visibility settings that can be made via the <code>set_visibility_for()</code> function are also taken into account by the Synchronizer.</p><p>As can be seen in the source code snippet below, we use our linked signals of <code>Area3D</code> to turn on/off the visibility of the respective game characters for the own GameClient. Here we benefit from the fact that we have named the respective game characters with the networkID of the GameClient. Here in this example project we do not check if the colliding <code>Node3D</code> objects are really other game characters for the sake of simplicity. Normally this would have to be evaluated or better <code>CollisionLayer</code> and <code>CollisionMask</code> would have to be configured in such a way that collisions can only be triggered by other game figures or their actions.</p><div class="message is-info"><div class=message-body>The <code>Player</code> scene must of course be extended in both the WorldServer and the GameClient. Strictly speaking, it is sufficient to set only the <code>public_visibility</code> property of the <code>ServerSynchronizer</code> to <code>false</code> in the GameClient, since we do the collision detection with the <em>Area of Interest</em> exclusively on the server. Therefore the following script extension is only necessary in the WorldServer.</div></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript data-lang=gdscript><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span><span><span style=color:#66d9ef>func</span> _on_area_3d_body_entered(body: Node3D) <span style=color:#f92672>-&gt;</span> void:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span><span>	synchronizer<span style=color:#f92672>.</span>set_visibility_for(str(body<span style=color:#f92672>.</span>name)<span style=color:#f92672>.</span>to_int(), true)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span><span style=color:#66d9ef>func</span> _on_area_3d_body_exited(body: Node3D) <span style=color:#f92672>-&gt;</span> void:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span><span>	synchronizer<span style=color:#f92672>.</span>set_visibility_for(str(body<span style=color:#f92672>.</span>name)<span style=color:#f92672>.</span>to_int(), false)</span></span></code></pre></div><p>Once these changes are made, nothing should stand in the way of the test run. I hope that I have not forgotten anything and that it was understandable so far. I find the Godot implementation of <em>Interest Management</em> quite elegant, as it is not only functional, but gives the developers the freedom to determine themselves what their visibility criteria are for the respective <em>Area of Interest</em>. You don&rsquo;t have to work with collisions, as in this example, you are completely free or, to quote German politicians, &ldquo;open to technology&rdquo; ðŸ˜‰.</p><p>With this technology it should even be possible to develop a system that works similar to the layering in World of Warcraft Classic. Since there are often many more players in certain areas at the start of an addon than a few weeks after the launch, players are assigned to certain layers and then only see players and NPC / monsters of the same layer. Groups are of course merged on one layer, so that you can also see and play with your own group members.</p><p>Of course the finished project is available in the usual <a href=https://github.com/somethinglikegames/godot4-network-tutorial/tree/interest-management target=_blank rel="noopener nofollow noreferrer">Github repository</a> for your own use.</p></div></article><footer class=columns><div class="column has-text-left"><a href=/en/blog/2023/dtls-security-4.1/ class="button right"><span class=icon-text><span class=icon><i class="fa fa-angle-left"></i></span><span>DTLS security changes with Godot 4.1</span></span></a></div><div class="column has-text-right"></div></footer></div></div></div></section><footer class=footer><div class="container is-fluid has-text-centered"><ul class=socnet-icons><span class=icon><a href=//github.com/somethinglikegames target=_blank rel=noopener title=GitHub class="fab fa-github"></a></span>
<span class=icon><a href=//youtube.com/@somethinglikegames target=_blank rel=noopener title=YouTube class="fab fa-youtube"></a></span>
<span id=cloaked-4f78e4ca5d></span>
<script id=cloaked-script-4f78e4ca5d>var cloakElement=document.getElementById("cloaked-4f78e4ca5d"),link=document.createElement("a"),address="ed.semagekilgnihtemos@ofni".split("").reverse().join("");link.href="mailto:"+address,link.classList="far fa-envelope",link.title="email",cloakElement.parentNode.replaceChild(link,cloakElement)</script></ul><p class=copyright><a href=https://www.somethinglikegames.de/en/legal_notice/>Legal Notice</a> &mdash;
<a href=https://www.somethinglikegames.de/en/privacy_policy/>Privacy Policy</a> &mdash;
Â©2023 Tobias Wink<br>Powered by <a href=https://gohugo.io/ title=0.109.0 target=_blank rel=noopener>Hugo</a></p></div></footer><script src=/js/navbar.min.js defer></script>
<script src=/js/copy-code-button.min.js defer></script></body></html>